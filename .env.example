# ==============================================================================
# CRM IMMOBILIARE - CONFIGURAZIONE UNIFICATA
# ==============================================================================
#
# SETUP RAPIDO:
# 1. Esegui lo script di setup automatico:
#    npm run setup
#
# 2. Oppure copia manualmente questo file come .env:
#    cp .env.example .env
#
# 3. I secrets vengono generati automaticamente se lasciati vuoti
#
# 4. Configura API keys via GUI dopo l'avvio:
#    - Avvia: npm run dev (locale) o docker-compose up -d (produzione)
#    - Apri: http://localhost:3000
#    - Il wizard di setup ti guiderà nella configurazione
#
# ==============================================================================

# ------------------------------------------------------------------------------
# DATABASE
# ------------------------------------------------------------------------------
# Development: SQLite (automatico, nessuna configurazione richiesta)
# Production: PostgreSQL (automatico in Docker)
#
# Per sviluppo locale con SQLite (default):
DATABASE_URL="file:./database/prisma/dev.db"
#
# Per sviluppo locale con PostgreSQL (richiede installazione):
# DATABASE_URL="postgresql://crm_user:crm_password@localhost:5432/crm_immobiliare"

# Credenziali PostgreSQL (usate solo in Docker)
POSTGRES_USER=crm_user
POSTGRES_DB=crm_immobiliare
POSTGRES_PASSWORD=
# ⚠️ IMPORTANTE: La password verrà auto-generata se lasciata vuota
# In produzione, imposta una password forte o lascia che venga generata

POSTGRES_PORT=5432

# ------------------------------------------------------------------------------
# AUTHENTICATION & SECURITY
# ------------------------------------------------------------------------------
# ⚠️ Questi secrets vengono AUTO-GENERATI se lasciati vuoti
# Non devi fare nulla, lo script di setup li genera per te

# Session secret (auto-generato)
SESSION_SECRET=

# NextAuth secret (auto-generato)
NEXTAUTH_SECRET=

# URL applicazione
# Development: http://localhost:3000
# Production: https://tuo-dominio.com
NEXTAUTH_URL=http://localhost:3000

# ------------------------------------------------------------------------------
# API KEYS
# ------------------------------------------------------------------------------
# ⚠️ OPZIONALE: Puoi configurare le API keys qui OPPURE tramite GUI dopo l'avvio
#
# Google AI Studio (Gemini) - Usata per TUTTE le funzionalità AI:
# - CRM Chatbot (assistente intelligente con 11 tools)
# - Semantic Search (ricerca avanzata)
# - Market Insights (analisi mercato)
# - Portfolio Analysis (statistiche)
#
# NOTA: Property Matching usa algoritmo deterministico (no AI, gratis!)
#
# Ottieni la chiave GRATUITA su: https://aistudio.google.com/app/apikey
GOOGLE_API_KEY=

# OpenRouter API (OPZIONALE - non ancora implementato)
OPENROUTER_API_KEY=

# ------------------------------------------------------------------------------
# APPLICATION
# ------------------------------------------------------------------------------
# Ambiente (development o production)
NODE_ENV=development

# Porte applicazione (modificare solo se in conflitto)
APP_PORT=3000
AI_PORT=8000

# URL Backend AI (FastAPI)
# Development: locale
# Production: servizio Docker/Railway
AI_BACKEND_URL=http://localhost:8000

# ------------------------------------------------------------------------------
# GITHUB CONTAINER REGISTRY (per Docker auto-update)
# ------------------------------------------------------------------------------
# Owner repository GitHub (usato da Watchtower per scaricare immagini)
GITHUB_REPOSITORY_OWNER=cookkie03

# ------------------------------------------------------------------------------
# WATCHTOWER AUTO-UPDATE (opzionale, solo Docker)
# ------------------------------------------------------------------------------
# Frequenza controllo aggiornamenti in secondi (default: 300 = 5 minuti)
WATCHTOWER_POLL_INTERVAL=300

# Debug mode per log dettagliati Watchtower (true/false)
WATCHTOWER_DEBUG=false

# Notifiche Slack (opzionale)
# WATCHTOWER_NOTIFICATIONS=slack
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# ------------------------------------------------------------------------------
# AI CONFIGURATION (opzionale, usa defaults intelligenti)
# ------------------------------------------------------------------------------
# Modello Google AI (default: gemini-2.5-flash - latest stable)
GOOGLE_MODEL=gemini-2.5-flash

# Temperature generazione AI (0.0 - 1.0, default: 0.3 per determinismo)
AI_TEMPERATURE=0.3

# Max tokens per risposta (default: 8192)
AI_MAX_TOKENS=8192

# Timeout richieste AI in secondi (default: 60)
AI_TIMEOUT=60

# Retry automatici per fallimenti temporanei (default: 3)
AI_MAX_RETRIES=3
AI_RETRY_DELAY=2

# ------------------------------------------------------------------------------
# RAG (Retrieval-Augmented Generation) CONFIGURATION (opzionale)
# ------------------------------------------------------------------------------
# Numero documenti da recuperare (default: 5)
RAG_TOP_K=5

# Chunk size per document splitting (default: 512)
RAG_CHUNK_SIZE=512

# Chunk overlap (default: 50)
RAG_CHUNK_OVERLAP=50

# Embedding model (default: text-embedding-004)
EMBEDDING_MODEL=models/text-embedding-004

# ------------------------------------------------------------------------------
# VECTOR STORE (opzionale)
# ------------------------------------------------------------------------------
# Modalità Qdrant per RAG:
# - memory: In-memory, semplice, per sviluppo (default)
# - server: Docker, per produzione
QDRANT_MODE=memory

# Se QDRANT_MODE=server, configurare:
# QDRANT_HOST=localhost
# QDRANT_PORT=6333

# ------------------------------------------------------------------------------
# CACHING (opzionale)
# ------------------------------------------------------------------------------
# Directory cache (default: .cache, git-ignored)
CACHE_DIR=.cache

# TTL cache in secondi (default: 3600 = 1 ora)
CACHE_TTL=3600

# ------------------------------------------------------------------------------
# LOGGING (opzionale)
# ------------------------------------------------------------------------------
# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL (default: INFO)
LOG_LEVEL=INFO

# Log format: json, console (default: console)
LOG_FORMAT=console

# Abilita tracing OpenTelemetry (true/false, default: false)
ENABLE_TRACING=false

# Service name per tracing (default: crm-immobiliare-ai)
SERVICE_NAME=crm-immobiliare-ai

# ------------------------------------------------------------------------------
# CORS (opzionale, usa defaults intelligenti)
# ------------------------------------------------------------------------------
# CORS Origins per FastAPI (separati da virgola)
# Default: http://localhost:3000,http://127.0.0.1:3000
CORS_ORIGINS=http://localhost:3000,http://127.0.0.1:3000

# ------------------------------------------------------------------------------
# MAPS (OPZIONALE - Feature futura)
# ------------------------------------------------------------------------------
# Di default usa OpenStreetMap (gratuito, nessuna API key necessaria)
# Per mappe avanzate usa Mapbox: https://www.mapbox.com/
# MAPBOX_API_KEY=

# ------------------------------------------------------------------------------
# SCRAPING (OPZIONALE - Feature futura)
# ------------------------------------------------------------------------------
# Credenziali portali immobiliari (non ancora implementato)
# IMMOBILIARE_IT_USERNAME=
# IMMOBILIARE_IT_PASSWORD=
# IDEALISTA_IT_USERNAME=
# IDEALISTA_IT_PASSWORD=
# CASA_IT_USERNAME=
# CASA_IT_PASSWORD=

# ------------------------------------------------------------------------------
# EMAIL (OPZIONALE - Feature futura)
# ------------------------------------------------------------------------------
# SMTP per invio email automatiche (non ancora implementato)
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=
# SMTP_PASSWORD=
# SMTP_FROM=

# ==============================================================================
# ✅ CHECKLIST PRIMA DI AVVIARE:
# ==============================================================================
# [ ] Eseguito: npm run setup (auto-genera tutto ciò che serve)
#     OPPURE
# [ ] Copiato: .env.example → .env
# [ ] Generati secrets (automatico se lasciati vuoti)
# [ ] API keys: verranno richieste dal wizard di setup al primo avvio
#
# NOTA: Non devi compilare tutto subito!
# - I secrets vengono generati automaticamente
# - Le API keys si configurano via GUI dopo l'avvio
# - Solo DATABASE_URL serve per partire (già configurato di default)
#
# AVVIO RAPIDO:
# - Sviluppo locale: npm run dev
# - Produzione Docker: docker-compose up -d
# ==============================================================================
